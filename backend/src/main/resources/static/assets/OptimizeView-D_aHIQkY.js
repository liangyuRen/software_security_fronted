import{aE as Se,aG as me,bv as ke,bw as xe,by as Xe,bY as ge,bZ as Le,b_ as ze,b4 as fe,aH as ve,aP as Ae,r as z,g as S,w as J,b$ as be,bI as Me,E as Z,n as ye,d as G,aL as _e,h as Ie,y as Ve,A as y,K as _,F as R,C as O,G as c,N as H,a1 as t,H as U,bo as $e,I as se,_ as Fe,v as Ne,c0 as je,bC as Oe,bd as He,aR as Ge,aM as Ee,q as Ke,b8 as qe,c1 as Ze,aK as Je,aN as Qe,B as Q,M as X,a3 as A,ad as ie,J as De,aZ as el,bk as Pe,ag as he,Q as Be,bU as ll,a as tl,br as Re,a4 as al,a5 as nl,c2 as ol,a7 as sl,c3 as il,f as rl,ae as ul}from"./index-B9RSddI6.js";import{E as Ue}from"./el-input-number-Cv7HxLUV.js";import"./index-CO20o_4f.js";const We=Symbol("sliderContextKey"),dl=Se({modelValue:{type:me([Number,Array]),default:0},id:{type:String,default:void 0},min:{type:Number,default:0},max:{type:Number,default:100},step:{type:Number,default:1},showInput:Boolean,showInputControls:{type:Boolean,default:!0},size:ke,inputSize:ke,showStops:Boolean,showTooltip:{type:Boolean,default:!0},formatTooltip:{type:me(Function),default:void 0},disabled:Boolean,range:Boolean,vertical:Boolean,height:String,debounce:{type:Number,default:300},rangeStartLabel:{type:String,default:void 0},rangeEndLabel:{type:String,default:void 0},formatValueText:{type:me(Function),default:void 0},tooltipClass:{type:String,default:void 0},placement:{type:String,values:xe,default:"top"},marks:{type:me(Object)},validateEvent:{type:Boolean,default:!0},...Xe(["ariaLabel"])}),pe=e=>fe(e)||ve(e)&&e.every(fe),cl={[ge]:pe,[Le]:pe,[ze]:pe},ml=Se({modelValue:{type:Number,default:0},vertical:Boolean,tooltipClass:String,placement:{type:String,values:xe,default:"top"}}),vl={[ge]:e=>fe(e)},fl=(e,l,i)=>{const a=z(),o=z(!1),u=S(()=>l.value instanceof Function),s=S(()=>u.value&&l.value(e.modelValue)||e.modelValue),h=Me(()=>{i.value&&(o.value=!0)},50),d=Me(()=>{i.value&&(o.value=!1)},50);return{tooltip:a,tooltipVisible:o,formatValue:s,displayTooltip:h,hideTooltip:d}},gl=(e,l,i)=>{const{disabled:a,min:o,max:u,step:s,showTooltip:h,precision:d,sliderSize:r,formatTooltip:g,emitChange:n,resetSize:v,updateDragging:V}=Ae(We),{tooltip:T,tooltipVisible:W,formatValue:I,displayTooltip:x,hideTooltip:k}=fl(e,g,h),N=z(),p=S(()=>`${(e.modelValue-o.value)/(u.value-o.value)*100}%`),$=S(()=>e.vertical?{bottom:p.value}:{left:p.value}),Y=()=>{l.hovering=!0,x()},te=()=>{l.hovering=!1,l.dragging||k()},re=b=>{a.value||(b.preventDefault(),oe(b),window.addEventListener("mousemove",F),window.addEventListener("touchmove",F),window.addEventListener("mouseup",P),window.addEventListener("touchend",P),window.addEventListener("contextmenu",P),N.value.focus())},j=b=>{a.value||(l.newPosition=Number.parseFloat(p.value)+b/(u.value-o.value)*100,K(l.newPosition),n())},ue=()=>{j(-s.value)},D=()=>{j(s.value)},f=()=>{j(-s.value*4)},w=()=>{j(s.value*4)},E=()=>{a.value||(K(0),n())},ae=()=>{a.value||(K(100),n())},ne=b=>{let L=!0;switch(b.code){case Z.left:case Z.down:ue();break;case Z.right:case Z.up:D();break;case Z.home:E();break;case Z.end:ae();break;case Z.pageDown:f();break;case Z.pageUp:w();break;default:L=!1;break}L&&b.preventDefault()},ee=b=>{let L,B;return b.type.startsWith("touch")?(B=b.touches[0].clientY,L=b.touches[0].clientX):(B=b.clientY,L=b.clientX),{clientX:L,clientY:B}},oe=b=>{l.dragging=!0,l.isClick=!0;const{clientX:L,clientY:B}=ee(b);e.vertical?l.startY=B:l.startX=L,l.startPosition=Number.parseFloat(p.value),l.newPosition=l.startPosition},F=b=>{if(l.dragging){l.isClick=!1,x(),v();let L;const{clientX:B,clientY:q}=ee(b);e.vertical?(l.currentY=q,L=(l.startY-l.currentY)/r.value*100):(l.currentX=B,L=(l.currentX-l.startX)/r.value*100),l.newPosition=l.startPosition+L,K(l.newPosition)}},P=()=>{l.dragging&&(setTimeout(()=>{l.dragging=!1,l.hovering||k(),l.isClick||K(l.newPosition),n()},0),window.removeEventListener("mousemove",F),window.removeEventListener("touchmove",F),window.removeEventListener("mouseup",P),window.removeEventListener("touchend",P),window.removeEventListener("contextmenu",P))},K=async b=>{if(b===null||Number.isNaN(+b))return;b<0?b=0:b>100&&(b=100);const L=100/((u.value-o.value)/s.value);let q=Math.round(b/L)*L*(u.value-o.value)*.01+o.value;q=Number.parseFloat(q.toFixed(d.value)),q!==e.modelValue&&i(ge,q),!l.dragging&&e.modelValue!==l.oldValue&&(l.oldValue=e.modelValue),await ye(),l.dragging&&x(),T.value.updatePopper()};return J(()=>l.dragging,b=>{V(b)}),be(N,"touchstart",re,{passive:!1}),{disabled:a,button:N,tooltip:T,tooltipVisible:W,showTooltip:h,wrapperStyle:$,formatValue:I,handleMouseEnter:Y,handleMouseLeave:te,onButtonDown:re,onKeyDown:ne,setPosition:K}},bl=G({name:"ElSliderButton"}),yl=G({...bl,props:ml,emits:vl,setup(e,{expose:l,emit:i}){const a=e,o=_e("slider"),u=Ie({hovering:!1,dragging:!1,isClick:!1,startX:0,currentX:0,startY:0,currentY:0,startPosition:0,newPosition:0,oldValue:a.modelValue}),{disabled:s,button:h,tooltip:d,showTooltip:r,tooltipVisible:g,wrapperStyle:n,formatValue:v,handleMouseEnter:V,handleMouseLeave:T,onButtonDown:W,onKeyDown:I,setPosition:x}=gl(a,u,i),{hovering:k,dragging:N}=Ve(u);return l({onButtonDown:W,onKeyDown:I,setPosition:x,hovering:k,dragging:N}),(p,$)=>(y(),_("div",{ref_key:"button",ref:h,class:U([t(o).e("button-wrapper"),{hover:t(k),dragging:t(N)}]),style:se(t(n)),tabindex:t(s)?-1:0,onMouseenter:t(V),onMouseleave:t(T),onMousedown:t(W),onFocus:t(V),onBlur:t(T),onKeydown:t(I)},[R(t($e),{ref_key:"tooltip",ref:d,visible:t(g),placement:p.placement,"fallback-placements":["top","bottom","right","left"],"stop-popper-mouse-event":!1,"popper-class":p.tooltipClass,disabled:!t(r),persistent:t(r)},{content:O(()=>[c("span",null,H(t(v)),1)]),default:O(()=>[c("div",{class:U([t(o).e("button"),{hover:t(k),dragging:t(N)}])},null,2)]),_:1},8,["visible","placement","popper-class","disabled","persistent"])],46,["tabindex","onMouseenter","onMouseleave","onMousedown","onFocus","onBlur","onKeydown"]))}});var Ce=Fe(yl,[["__file","button.vue"]]);const hl=Se({mark:{type:me([String,Object]),default:void 0}});var pl=G({name:"ElSliderMarker",props:hl,setup(e){const l=_e("slider"),i=S(()=>Ne(e.mark)?e.mark:e.mark.label),a=S(()=>Ne(e.mark)?void 0:e.mark.style);return()=>je("div",{class:l.e("marks-text"),style:a.value},i.value)}});const Vl=(e,l,i)=>{const{form:a,formItem:o}=Oe(),u=He(),s=z(),h=z(),d={firstButton:s,secondButton:h},r=S(()=>e.disabled||(a==null?void 0:a.disabled)||!1),g=S(()=>Math.min(l.firstValue,l.secondValue)),n=S(()=>Math.max(l.firstValue,l.secondValue)),v=S(()=>e.range?`${100*(n.value-g.value)/(e.max-e.min)}%`:`${100*(l.firstValue-e.min)/(e.max-e.min)}%`),V=S(()=>e.range?`${100*(g.value-e.min)/(e.max-e.min)}%`:"0%"),T=S(()=>e.vertical?{height:e.height}:{}),W=S(()=>e.vertical?{height:v.value,bottom:V.value}:{width:v.value,left:V.value}),I=()=>{u.value&&(l.sliderSize=u.value[`client${e.vertical?"Height":"Width"}`])},x=f=>{const w=e.min+f*(e.max-e.min)/100;if(!e.range)return s;let E;return Math.abs(g.value-w)<Math.abs(n.value-w)?E=l.firstValue<l.secondValue?"firstButton":"secondButton":E=l.firstValue>l.secondValue?"firstButton":"secondButton",d[E]},k=f=>{const w=x(f);return w.value.setPosition(f),w},N=f=>{l.firstValue=f??e.min,$(e.range?[g.value,n.value]:f??e.min)},p=f=>{l.secondValue=f,e.range&&$([g.value,n.value])},$=f=>{i(ge,f),i(Le,f)},Y=async()=>{await ye(),i(ze,e.range?[g.value,n.value]:e.modelValue)},te=f=>{var w,E,ae,ne,ee,oe;if(r.value||l.dragging)return;I();let F=0;if(e.vertical){const P=(ae=(E=(w=f.touches)==null?void 0:w.item(0))==null?void 0:E.clientY)!=null?ae:f.clientY;F=(u.value.getBoundingClientRect().bottom-P)/l.sliderSize*100}else{const P=(oe=(ee=(ne=f.touches)==null?void 0:ne.item(0))==null?void 0:ee.clientX)!=null?oe:f.clientX,K=u.value.getBoundingClientRect().left;F=(P-K)/l.sliderSize*100}if(!(F<0||F>100))return k(F)};return{elFormItem:o,slider:u,firstButton:s,secondButton:h,sliderDisabled:r,minValue:g,maxValue:n,runwayStyle:T,barStyle:W,resetSize:I,setPosition:k,emitChange:Y,onSliderWrapperPrevent:f=>{var w,E;((w=d.firstButton.value)!=null&&w.dragging||(E=d.secondButton.value)!=null&&E.dragging)&&f.preventDefault()},onSliderClick:f=>{te(f)&&Y()},onSliderDown:async f=>{const w=te(f);w&&(await ye(),w.value.onButtonDown(f))},onSliderMarkerDown:f=>{r.value||l.dragging||k(f)},setFirstValue:N,setSecondValue:p}},Sl=(e,l,i,a)=>({stops:S(()=>{if(!e.showStops||e.min>e.max)return[];if(e.step===0)return[];const s=(e.max-e.min)/e.step,h=100*e.step/(e.max-e.min),d=Array.from({length:s-1}).map((r,g)=>(g+1)*h);return e.range?d.filter(r=>r<100*(i.value-e.min)/(e.max-e.min)||r>100*(a.value-e.min)/(e.max-e.min)):d.filter(r=>r>100*(l.firstValue-e.min)/(e.max-e.min))}),getStopStyle:s=>e.vertical?{bottom:`${s}%`}:{left:`${s}%`}}),Ll=e=>S(()=>e.marks?Object.keys(e.marks).map(Number.parseFloat).sort((i,a)=>i-a).filter(i=>i<=e.max&&i>=e.min).map(i=>({point:i,position:(i-e.min)*100/(e.max-e.min),mark:e.marks[i]})):[]),_l=(e,l,i,a,o,u)=>{const s=r=>{o(ge,r),o(Le,r)},h=()=>e.range?![i.value,a.value].every((r,g)=>r===l.oldValue[g]):e.modelValue!==l.oldValue,d=()=>{var r,g;e.min>e.max&&Ge("Slider","min should not be greater than max.");const n=e.modelValue;e.range&&ve(n)?n[1]<e.min?s([e.min,e.min]):n[0]>e.max?s([e.max,e.max]):n[0]<e.min?s([e.min,n[1]]):n[1]>e.max?s([n[0],e.max]):(l.firstValue=n[0],l.secondValue=n[1],h()&&(e.validateEvent&&((r=u==null?void 0:u.validate)==null||r.call(u,"change").catch(v=>Ee())),l.oldValue=n.slice())):!e.range&&fe(n)&&!Number.isNaN(n)&&(n<e.min?s(e.min):n>e.max?s(e.max):(l.firstValue=n,h()&&(e.validateEvent&&((g=u==null?void 0:u.validate)==null||g.call(u,"change").catch(v=>Ee())),l.oldValue=n)))};d(),J(()=>l.dragging,r=>{r||d()}),J(()=>e.modelValue,(r,g)=>{l.dragging||ve(r)&&ve(g)&&r.every((n,v)=>n===g[v])&&l.firstValue===r[0]&&l.secondValue===r[1]||d()},{deep:!0}),J(()=>[e.min,e.max],()=>{d()})},wl=(e,l,i)=>{const a=z();return Ke(async()=>{e.range?(ve(e.modelValue)?(l.firstValue=Math.max(e.min,e.modelValue[0]),l.secondValue=Math.min(e.max,e.modelValue[1])):(l.firstValue=e.min,l.secondValue=e.max),l.oldValue=[l.firstValue,l.secondValue]):(!fe(e.modelValue)||Number.isNaN(e.modelValue)?l.firstValue=e.min:l.firstValue=Math.min(e.max,Math.max(e.min,e.modelValue)),l.oldValue=l.firstValue),be(window,"resize",i),await ye(),i()}),{sliderWrapper:a}},Tl=G({name:"ElSlider"}),kl=G({...Tl,props:dl,emits:cl,setup(e,{expose:l,emit:i}){const a=e,o=_e("slider"),{t:u}=qe(),s=Ie({firstValue:0,secondValue:0,oldValue:0,dragging:!1,sliderSize:1}),{elFormItem:h,slider:d,firstButton:r,secondButton:g,sliderDisabled:n,minValue:v,maxValue:V,runwayStyle:T,barStyle:W,resetSize:I,emitChange:x,onSliderWrapperPrevent:k,onSliderClick:N,onSliderDown:p,onSliderMarkerDown:$,setFirstValue:Y,setSecondValue:te}=Vl(a,s,i),{stops:re,getStopStyle:j}=Sl(a,s,v,V),{inputId:ue,isLabeledByFormItem:D}=Ze(a,{formItemContext:h}),f=Je(),w=S(()=>a.inputSize||f.value),E=S(()=>a.ariaLabel||u("el.slider.defaultLabel",{min:a.min,max:a.max})),ae=S(()=>a.range?a.rangeStartLabel||u("el.slider.defaultRangeStartLabel"):E.value),ne=S(()=>a.formatValueText?a.formatValueText(L.value):`${L.value}`),ee=S(()=>a.rangeEndLabel||u("el.slider.defaultRangeEndLabel")),oe=S(()=>a.formatValueText?a.formatValueText(B.value):`${B.value}`),F=S(()=>[o.b(),o.m(f.value),o.is("vertical",a.vertical),{[o.m("with-input")]:a.showInput}]),P=Ll(a);_l(a,s,v,V,i,h);const K=S(()=>{const m=[a.min,a.max,a.step].map(we=>{const de=`${we}`.split(".")[1];return de?de.length:0});return Math.max.apply(null,m)}),{sliderWrapper:b}=wl(a,s,I),{firstValue:L,secondValue:B,sliderSize:q}=Ve(s),Ye=m=>{s.dragging=m};return be(b,"touchstart",k,{passive:!1}),be(b,"touchmove",k,{passive:!1}),Qe(We,{...Ve(a),sliderSize:q,disabled:n,precision:K,emitChange:x,resetSize:I,updateDragging:Ye}),l({onSliderClick:N}),(m,we)=>{var de,Te;return y(),_("div",{id:m.range?t(ue):void 0,ref_key:"sliderWrapper",ref:b,class:U(t(F)),role:m.range?"group":void 0,"aria-label":m.range&&!t(D)?t(E):void 0,"aria-labelledby":m.range&&t(D)?(de=t(h))==null?void 0:de.labelId:void 0},[c("div",{ref_key:"slider",ref:d,class:U([t(o).e("runway"),{"show-input":m.showInput&&!m.range},t(o).is("disabled",t(n))]),style:se(t(T)),onMousedown:t(p),onTouchstartPassive:t(p)},[c("div",{class:U(t(o).e("bar")),style:se(t(W))},null,6),R(Ce,{id:m.range?void 0:t(ue),ref_key:"firstButton",ref:r,"model-value":t(L),vertical:m.vertical,"tooltip-class":m.tooltipClass,placement:m.placement,role:"slider","aria-label":m.range||!t(D)?t(ae):void 0,"aria-labelledby":!m.range&&t(D)?(Te=t(h))==null?void 0:Te.labelId:void 0,"aria-valuemin":m.min,"aria-valuemax":m.range?t(B):m.max,"aria-valuenow":t(L),"aria-valuetext":t(ne),"aria-orientation":m.vertical?"vertical":"horizontal","aria-disabled":t(n),"onUpdate:modelValue":t(Y)},null,8,["id","model-value","vertical","tooltip-class","placement","aria-label","aria-labelledby","aria-valuemin","aria-valuemax","aria-valuenow","aria-valuetext","aria-orientation","aria-disabled","onUpdate:modelValue"]),m.range?(y(),Q(Ce,{key:0,ref_key:"secondButton",ref:g,"model-value":t(B),vertical:m.vertical,"tooltip-class":m.tooltipClass,placement:m.placement,role:"slider","aria-label":t(ee),"aria-valuemin":t(L),"aria-valuemax":m.max,"aria-valuenow":t(B),"aria-valuetext":t(oe),"aria-orientation":m.vertical?"vertical":"horizontal","aria-disabled":t(n),"onUpdate:modelValue":t(te)},null,8,["model-value","vertical","tooltip-class","placement","aria-label","aria-valuemin","aria-valuemax","aria-valuenow","aria-valuetext","aria-orientation","aria-disabled","onUpdate:modelValue"])):X("v-if",!0),m.showStops?(y(),_("div",{key:1},[(y(!0),_(A,null,ie(t(re),(le,ce)=>(y(),_("div",{key:ce,class:U(t(o).e("stop")),style:se(t(j)(le))},null,6))),128))])):X("v-if",!0),t(P).length>0?(y(),_(A,{key:2},[c("div",null,[(y(!0),_(A,null,ie(t(P),(le,ce)=>(y(),_("div",{key:ce,style:se(t(j)(le.position)),class:U([t(o).e("stop"),t(o).e("marks-stop")])},null,6))),128))]),c("div",{class:U(t(o).e("marks"))},[(y(!0),_(A,null,ie(t(P),(le,ce)=>(y(),Q(t(pl),{key:ce,mark:le.mark,style:se(t(j)(le.position)),onMousedown:De(it=>t($)(le.position),["stop"])},null,8,["mark","style","onMousedown"]))),128))],2)],64)):X("v-if",!0)],46,["onMousedown","onTouchstartPassive"]),m.showInput&&!m.range?(y(),Q(t(Ue),{key:0,ref:"input","model-value":t(L),class:U(t(o).e("input")),step:m.step,disabled:t(n),controls:m.showInputControls,min:m.min,max:m.max,precision:t(K),debounce:m.debounce,size:t(w),"onUpdate:modelValue":t(Y),onChange:t(x)},null,8,["model-value","class","step","disabled","controls","min","max","precision","debounce","size","onUpdate:modelValue","onChange"])):X("v-if",!0)],10,["id","role","aria-label","aria-labelledby"])}}});var Ml=Fe(kl,[["__file","slider.vue"]]);const Nl=el(Ml),El={class:"info"},Pl={class:"label"},Bl={class:"input"},Cl={class:"data"},xl={class:"text"},zl=G({__name:"EditableField",props:{label:String,modelValue:[Number,String],inputType:{type:String,default:"el-input-number"},inputProps:{type:Object,default:()=>({})}},emits:["update:modelValue"],setup(e,{emit:l}){const i=e,a=l,o=z(!1),u=z(i.modelValue);J(()=>i.modelValue,d=>{u.value=d});function s(){a("update:modelValue",u.value),o.value=!1}function h(){o.value=!1,u.value=i.modelValue}return(d,r)=>{const g=Nl,n=Ue;return y(),_("div",El,[c("div",Pl,H(e.label),1),o.value?(y(),_(A,{key:0},[c("div",Bl,[e.inputType=="ElSlider"?(y(),Q(g,Pe({key:0,modelValue:u.value,"onUpdate:modelValue":r[0]||(r[0]=v=>u.value=v)},e.inputProps),null,16,["modelValue"])):e.inputType=="ElInputNumber"?(y(),Q(n,Pe({key:1,modelValue:u.value,"onUpdate:modelValue":r[1]||(r[1]=v=>u.value=v)},e.inputProps),null,16,["modelValue"])):X("",!0)]),c("div",{class:"text"},[c("span",{class:"edit",onClick:s},"确认修改"),c("span",{class:"cancel",onClick:h},"取消")])],64)):(y(),_(A,{key:1},[c("div",Cl,H(e.modelValue),1),c("div",xl,[c("span",{class:"edit",onClick:r[2]||(r[2]=v=>o.value=!0)},"修改")])],64))])}}}),Il=he(zl,[["__scopeId","data-v-21870ab5"]]),$l={class:"data-setting"},Fl=G({__name:"DataSetting",props:{thresholdName:{default:"相似度阈值"},threshold:{},K:{}},emits:["update:threshold","update:K"],setup(e,{emit:l}){const i=e,a=z(i.threshold),o=z(i.K),u=l,s=d=>{a.value=d,u("update:threshold",d)},h=d=>{o.value=d,u("update:K",d)};return J(()=>i.threshold,d=>{a.value=d}),J(()=>i.K,d=>{o.value=d}),(d,r)=>{const g=Il;return y(),_("div",$l,[R(g,{label:d.thresholdName,modelValue:a.value,"onUpdate:modelValue":[r[0]||(r[0]=n=>a.value=n),s],inputType:"ElSlider",inputProps:{min:0,max:1,step:.05,showInput:!0}},null,8,["label","modelValue"]),R(g,{label:"单位漏洞报告中检测出漏洞库的最大数量",modelValue:o.value,"onUpdate:modelValue":[r[1]||(r[1]=n=>o.value=n),h],inputType:"ElInputNumber",inputProps:{min:1,max:128}},null,8,["modelValue"])])}}}),Kl=he(Fl,[["__scopeId","data-v-1da16a8d"]]),Rl={class:"llm-card"},Ul={class:"header"},Wl={class:"right"},Yl={key:0,class:"tag",style:{backgroundColor:"#E4FBE5",color:"#3EC01E"}},Xl={key:1,class:"tag",style:{backgroundColor:"#FFF5EB",color:"#FE8B00"}},Al={class:"text"},jl={class:"footer"},Ol={key:1,class:"no-vip"},Hl=G({__name:"LlmInfo",props:{info:{},isChosen:{type:Boolean,default:!1},isVip:{type:Boolean,default:!1}},emits:["update:name"],setup(e,{emit:l}){const i=l;return(a,o)=>{const u=ll,s=tl;return y(),_("div",Rl,[c("div",Ul,[c("h4",null,H(a.info.llmName),1),c("div",Wl,[a.info.infoTag?(y(),_("div",Yl,H(a.info.infoTag),1)):X("",!0),a.info.needVip?(y(),_("div",Xl,"会员专享")):X("",!0),a.isChosen?(y(),Q(u,{key:2,type:"primary"},{default:O(()=>o[1]||(o[1]=[Be("已选择")])),_:1})):X("",!0)])]),c("div",Al,H(a.info.desc),1),c("div",jl,[o[3]||(o[3]=c("div",{class:"data-info"},null,-1)),!a.info.needVip||a.info.needVip&&a.isVip?(y(),Q(s,{key:0,class:"llm-button",type:"primary",onClick:o[0]||(o[0]=h=>i("update:name",a.info.llmName))},{default:O(()=>o[2]||(o[2]=[Be(" 选用该模型 ")])),_:1})):X("",!0),a.info.needVip&&!a.isVip?(y(),_("div",Ol,"非会员无法使用")):X("",!0)])])}}}),Gl=he(Hl,[["__scopeId","data-v-b690077a"]]);var C=(e=>(e[e.PreTrain=0]="PreTrain",e[e.LLM=1]="LLM",e))(C||{}),M=(e=>(e[e.Similarity=0]="Similarity",e[e.WhiteList=1]="WhiteList",e[e.None=2]="None",e))(M||{});const ql=e=>{const i={companyId:1,similarityThreshold:e.similarityThreshold,detect_strategy:e.detectStrategy,maxDetectNums:e.maxDetectNums};return Re.post("/company/updateStrategy",i)},Zl=()=>Re.get("/company/getStrategy",{params:{companyId:1}}),Jl={class:"filter"},Ql={class:"filter-line"},Dl={class:"filter-list"},et=["onClick"],lt={class:"filter-line"},tt={class:"filter-list"},at=["onClick"],nt={class:"text"},ot={class:"llm-list"},st=G({__name:"OptimizeView",setup(e){const l=z({model:"all",optimize:"all"}),i=[{value:"all",label:"全部"},{value:C.PreTrain,label:"预训练模型"},{value:C.LLM,label:"大语言模型"}],a=[{value:"all",label:"全部"},{value:M.Similarity,label:"相似度算法优化器"},{value:M.WhiteList,label:"白名单优化器"},{value:M.None,label:"无"}],o=z([{llmName:"PreTrainModel",desc:"利用TF-IDF打分算法结合基于BERT-FNN的PreTrainModel方法进行检测，能够高效识别常见漏洞。",accuracy:.75,falseRate:.03,modelType:C.PreTrain,optimizeType:M.None},{llmName:"LLM",desc:"在PreTrainModel的识别基础上，使用大语言模型（LLM）进行漏洞检测，具有强大的漏洞检测能力。",accuracy:.85,falseRate:.01,modelType:C.LLM,optimizeType:M.None},{llmName:"LLM-lev",desc:"在LLM基础上结合Levenshtein距离相似度匹配算法，与您的企业白名单进行匹配，提升准确率。",accuracy:.9,falseRate:.015,modelType:C.LLM,optimizeType:M.Similarity},{llmName:"PreTrainModel-lev",desc:"在PreTrainModel基础上结合Levenshtein距离相似度匹配算法，与您的企业白名单进行匹配，提升准确率。",accuracy:.82,falseRate:.025,modelType:C.PreTrain,optimizeType:M.Similarity},{llmName:"LLM-cos",desc:"在LLM基础上结合余弦相似度匹配算法，与您的企业白名单进行匹配，提升准确率。",accuracy:.88,falseRate:.018,infoTag:"误报率较低",modelType:C.LLM,optimizeType:M.Similarity},{llmName:"PreTrainModel-cos",desc:"在PreTrainModel基础上结合余弦相似度匹配算法，与您的企业白名单进行匹配，提升准确率。",accuracy:.8,falseRate:.02,infoTag:"误报率较低",modelType:C.PreTrain,optimizeType:M.Similarity},{llmName:"LLM-lcs",desc:"在LLM基础上结合最长公共子序列（LCS）算法，与您的企业白名单进行匹配，提升准确率。",accuracy:.87,falseRate:.017,modelType:C.LLM,optimizeType:M.Similarity},{llmName:"PreTrainModel-lcs",desc:"在PreTrainModel基础上结合最长公共子序列（LCS）算法，与您的企业白名单进行匹配，提升准确率。",accuracy:.79,falseRate:.022,modelType:C.PreTrain,optimizeType:M.Similarity},{llmName:"LLM-VulDet",desc:"使用大语言模型（LLM）进行漏洞检测，能够检测出具体的版本信息。",accuracy:.79,falseRate:.022,infoTag:"版本检测",needVip:!0,modelType:C.LLM,optimizeType:M.None},{llmName:"LLM-whiteList",desc:"在LLM检测的流程中，定制化添加您的企业白名单，确保高准确率。通过阈值过滤的方式降低误报率。",accuracy:.92,falseRate:.01,infoTag:"准确率较高",needVip:!0,modelType:C.LLM,optimizeType:M.WhiteList},{llmName:"PreTrainModel-whiteList",desc:"在PreTrainModel检测的流程中，定制化添加您的企业白名单，确保高准确率。通过阈值过滤的方式降低误报率。",accuracy:.83,falseRate:.02,infoTag:"准确率较高",needVip:!0,modelType:C.PreTrain,optimizeType:M.WhiteList}]),u=S(()=>{const n=o.value.filter(({modelType:V})=>l.value.model=="all"?!0:l.value.model==V).filter(({optimizeType:V})=>{const{optimize:T}=l.value;return T=="all"?!0:T==V}),v=n.findIndex(V=>{var T;return V.llmName===((T=s.value)==null?void 0:T.detectStrategy)});if(v!==-1){const[V]=n.splice(v,1);n.unshift(V)}return n}),s=z({similarityThreshold:.7,maxDetectNums:3,detectStrategy:"LLM",isMember:1});Ke(()=>{Zl().then(n=>{s.value=n.data.obj})});const h=n=>{s.value&&(s.value.similarityThreshold=n,g())},d=n=>{s.value&&(s.value.maxDetectNums=n,g())};J(()=>{var n;return(n=s.value)==null?void 0:n.detectStrategy},n=>{console.log("change");const v=o.value.findIndex(V=>V.llmName===n);if(v!==-1){const[V]=o.value.splice(v,1);o.value.unshift(V)}},{immediate:!0});const r=n=>{s.value&&(s.value.detectStrategy=n,g())},g=()=>{s.value&&ql(s.value).then(()=>al.success("已成功修改配置"))};return(n,v)=>{var x,k,N;const V=rl,T=ul,W=nl,I=$e;return y(),_(A,null,[R(W,{"separator-icon":t(sl),class:"bread"},{default:O(()=>[R(T,{to:{path:"/optimize"}},{default:O(()=>[R(V,{color:"#336FFF",size:"14"},{default:O(()=>[R(t(ol))]),_:1}),v[0]||(v[0]=c("span",{class:"bread-item"},"应用优化",-1))]),_:1})]),_:1},8,["separator-icon"]),c("section",null,[R(Kl,{"threshold-name":(x=s.value)!=null&&x.detectStrategy.endsWith("whiteList")?"误报过滤阈值":"相似度阈值",threshold:((k=s.value)==null?void 0:k.similarityThreshold)??.5,K:((N=s.value)==null?void 0:N.maxDetectNums)??1,"onUpdate:threshold":h,"onUpdate:K":d},null,8,["threshold-name","threshold","K"]),c("div",Jl,[v[3]||(v[3]=c("h4",null,"模型筛选",-1)),c("div",Ql,[v[1]||(v[1]=c("div",{class:"label"},"模型",-1)),c("ul",Dl,[(y(),_(A,null,ie(i,p=>c("li",{key:p.value,onClick:$=>l.value.model=p.value,class:U({chosen:p.value===l.value.model})},H(p.label),11,et)),64))])]),c("div",lt,[v[2]||(v[2]=c("div",{class:"label"},"优化器",-1)),c("ul",tt,[(y(),_(A,null,ie(a,p=>c("li",{key:p.value,onClick:$=>l.value.optimize=p.value,class:U({chosen:p.value===l.value.optimize})},H(p.label),11,at)),64))])])]),c("div",nt,[c("span",null,"共"+H(u.value.length)+"个模型，请选择需要的优化策略",1),R(I,{class:"box-item",effect:"dark",content:"提高阈值能提升检测准确率, 但有可能减少预测结果",placement:"bottom"},{default:O(()=>[R(V,null,{default:O(()=>[R(t(il))]),_:1})]),_:1})]),c("div",ot,[(y(!0),_(A,null,ie(u.value,p=>{var $,Y;return y(),Q(Gl,{key:p.llmName,"is-vip":(($=s.value)==null?void 0:$.isMember)==1,"is-chosen":p.llmName==((Y=s.value)==null?void 0:Y.detectStrategy),info:p,"onUpdate:name":r},null,8,["is-vip","is-chosen","info"])}),128))])])],64)}}}),ct=he(st,[["__scopeId","data-v-277dc00a"]]);export{ct as default};
